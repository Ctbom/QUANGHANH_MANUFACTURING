
@{
    ViewBag.Title = "MonthlyQuarterlyReport";
    Layout = null;

}
<link href="~/assets/libs/chartist/dist/chartist.min.css" rel="stylesheet">
<link href="~/assets/libs/chartist-plugin-tooltips/dist/chartist-plugin-tooltip.css" rel="stylesheet">
<link href="~/dist/css/style.css" rel="stylesheet">
<link href="~/css/preloader/css.css" rel="stylesheet" />
<!-- This page CSS -->
<link href="~/assets/Custom css/TABLE_BORDERED.css" rel="stylesheet" />
<link href="~/assets/Custom css/floating-action-btn.css" rel="stylesheet">
<link href="~/assets/Custom css/form-input-border.css" rel="stylesheet">
<!--Custom Datepicker CSS-->
<link href="~/lib/datepicker_src/dist/css/datepicker.min.css" rel="stylesheet" type="text/css">
<link href="~/lib/datepicker_src/dist/css/custom.css " rel="stylesheet " type="text/css ">
<link href="~/lib/datepicker_src/dist/css/font.css" rel="stylesheet" type="text/css">
<link href="~/css/preloader/css.css" rel="stylesheet" />
<!--Font css-->
<link href="~/assets/Custom css/font-family.css" rel="stylesheet" />
<!-- ============================================================== -->
<!-- All Required js -->
<!-- ============================================================== -->
<script src="~/assets/libs/jquery/dist/jquery.min.js"></script>
<script src="~/dist/js/materialize.min.js"></script>
<script src="~/assets/libs/perfect-scrollbar/dist/js/perfect-scrollbar.jquery.min.js"></script>
<!-- ============================================================== -->
<!-- Apps -->
<!-- ============================================================== -->
<script src="~/dist/js/app.js"></script>
<script src="~/dist/js/app.init.js"></script>
<script src="~/dist/js/app-style-switcher.js"></script>
<!-- ============================================================== -->
<!-- Custom js -->
<!-- ============================================================== -->
<script src="~/dist/js/custom.min.js"></script>
<!-- ============================================================== -->
<!--Custom Datepicker CSS-->
<link href="/lib/datepicker_src/dist/css/datepicker.min.css" rel="stylesheet" type="text/css">
<link href="/lib/datepicker_src/dist/css/custom.css " rel="stylesheet " type="text/css ">
<link href="/lib/datepicker_src/dist/css/font.css" rel="stylesheet" type="text/css">

<!--QuangHanh Alert-->
<link href="~/assets/sweetalert/sweetalert2.min.css" rel="stylesheet" />
<script src="~/assets/sweetalert/alert-quanghanh-js.js"></script>
<script src="~/assets/sweetalert/sweetalert2.all.min.js"></script>
<script src="~/assets/sweetalert/sweetalert2.min.js"></script>

<!--Custom Datepicker JS-->
<script src="/lib/datepicker_src/dist/js/datepicker.js"></script>
<script src="/lib/datepicker_src/dist/js/i18n/datepicker.vi.js"></script>
<!-- This page plugin js -->
<style>
    body {
        background-color: #ffff
    }

    th, td {
        border: 1px solid;
    }

    th#odd {
        background-color: yellow !important
    }

    th#even {
        background-color: #99cc00 !important
    }

    .table-bordered th {
        vertical-align: middle !important;
        text-align: center !important;
        background-color: #f8f8f8 !important;
        padding: 5px;
    }

    table {
        background-color: white;
    }

    img {
        width: 80px;
    }

    #line1 {
        font-size: 20px;
    }

    #line2 {
        font-size: 25px;
    }

    .title-name {
        font-weight: 600;
        font-family: 'Times New Roman', Times, serif;
    }

    table td {
        vertical-align: middle;
        text-align: center;
    }

    .big-title {
        font-weight: 600;
        vertical-align: middle;
        margin-top: 35px;
    }

    th#doanhthu-cell {
        background-color: #ff9191 !important;
        font-size: 25px;
    }

    .red-title {
        color: red;
    }

    table th * {
        display: inline;
    }

    #header-of-page table td {
        border: 1px solid #ffff;
    }
</style>
<div class="row" id="header-of-page">
    <div class="col l4 m4 s12">
        <table>
            <tr>
                <td rowspan="2" id="tkv-logo">
                    <img src="~/assets/images/logo-tkv.png" />
                </td>
                <td id="line1" class="title-name">TẬP ĐOÀN CÔNG NGHIỆP THAN - KHOÁNG SẢN VIỆT NAM</td>
                <td rowspan="2" id="qh-logo">
                    <img src="~/assets/images/logo-qh.jpg" />
                </td>
            </tr>
            <tr>
                <td id="line2" class="title-name">CÔNG TY THAN QUANG HANH - TKV</td>
            </tr>
        </table>
    </div>
    <div class="col l8 m8 s12 center big-title">
        @*<table>
            <tr>
                <td rowspan="2">*@
        <h1><b>BẢNG TỔNG HỢP CÁC CHỈ TIÊU SẢN XUẤT THÁNG <span id='month'>@ViewBag.month</span> NĂM <span id='year'>@ViewBag.year</span></b></h1>
        @*</td>
                </tr>
            </table>*@

    </div>
    <div class="row">
        <div class="col l4 m4 s4">
            <input type="text" id="yearCalendar" class="form-control datepicker-here datepicker-add center"
                   data-language='vi'
                   data-min-view="months"
                   data-view="months"
                   data-date-format="MM-yyyy"
                   required value="@ViewBag.thisMonthYear" autocomplete="off" />

        </div>
        <div class="col l4 m4 s4">
            <button id="change" onclick="change()" class="btn blue modal-close btn-small">Đổi</button>
        </div>
    </div>
</div>
<table class="table striped table-responsive table-bordered" id="mainTable">
    <thead>
        <tr>
            <th rowspan="4">KH</th>
            <th colspan="4">PX Đào Lò 3</th>
            <th colspan="4">PX Đào Lò 5</th>
            <th colspan="4">PX Đào Lò 7</th>
            <th colspan="4">PX Đào Lò 8</th>
            <th colspan="2">PX Khai Thác 1</th>
            <th colspan="2">PX Khai Thác 2</th>
            <th colspan="2">PX Khai Thác 3</th>
            <th colspan="2">PX Khai Thác 4</th>
            <th colspan="2">PX Khai Thác 5</th>
            <th colspan="2">PX Khai Thác 6</th>
            <th colspan="2">PX Khai Thác 7</th>
            <th colspan="2">PX Khai Thác 8</th>
            <th colspan="2">PX Khai Thác 9</th>
            <th colspan="2">PX Khai Thác 10</th>
            <th colspan="2">PX Khai Thác 11</th>
            <th colspan="14">Kế hoạch các chỉ tiêu chủ yếu</th>
        </tr>
        <tr>
            <th colspan="4"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Than SX: </div><span></span></th>
            <th colspan="4"><div class="red-title">Than Sản Xuất: </div><span id="sanxuat-cell"></span></th>
            <th colspan="3"><div class="red-title">Mét Lò: </div><span class="metlo-cell"></span></th>
            <th colspan="4"><div class="red-title">Mét lò CBSX tự làm: </div><span id="trong-cell"></span></th>
            <th colspan="3"><div class="red-title">Tiêu thụ: </div><span id="tieuthu-cell"></span></th>
        </tr>
        <tr>
            <th colspan="4"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Mét Lò: </div><span></span></th>
            <th colspan="4"><div class="red-title">Than Hầm Lò:  </div><span id="hamlo-cell"></span></th>
            <th colspan="3"><div class="red-title">- XDCB: </div><span></span>0</th>
            <th colspan="4"><div class="red-title">Mét lò CBSX t.ngoài: </div><span id="ngoai-cell"></span></th>
            <th colspan="3"><div class="red-title">D.Huy: </div><span id="duonghuy-cell"></span></th>
        </tr>
        <tr>
            <th colspan="4"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="4"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="2"> <div class="red-title">Xén: </div><span></span></th>
            <th colspan="4"><div class="red-title">Than Lộ Thiên: </div><span id="lothien-cell"></span></th>
            <th colspan="3"><div class="red-title">- CBSX: </div><span class="metlo-cell"></span></th>
            <th colspan="4"></th>
            <th colspan="3"><div class="red-title">D.Thu: </div><span id="doanhthu-cell"></span> tỷ</th>
        </tr>
        <tr>
            <th rowspan="2"> Thực Hiện Ngày</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Mét Lò</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Mét Lò</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Mét Lò</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Mét Lò</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th colspan="2"> Than SX</th>
            <th id="odd" colspan="2"> Doanh thu</th>
            <th id="even" colspan="2"> Than Sản Xuất</th>
            <th id="odd" colspan="2"> Than Hầm Lò</th>
            <th id="even" colspan="2"> Than Lộ Thiên</th>
            <th id="odd" colspan="2"> Mét Lò</th>
            <th id="even" colspan="2"> Dương Huy</th>
            <th id="odd" colspan="2"> Than Tiêu Thụ</th>
        </tr>
        <tr>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
            <th>Ngày</th>
            <th>Luỹ Kế</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
<script>
    function dateFormat2(d) {
        var dateString = d.substr(6);
        var currentTime = new Date(parseInt(dateString));
        var month = currentTime.getMonth() + 1;
        var day = currentTime.getDate();
        var year = currentTime.getFullYear();
        var date = day + "/" + month + "/" + year;
        return (date);
    }
    $(document).ready(function () {
        $("#change").click();
    });
    var temp = 1;
    function change() {
        $.ajax({
            'url': '/phong-dieu-khien/bao-cao-ngay-trong-thang/lay-du-lieu',
            'type': 'post',
            'data': {
                'month': $("#yearCalendar").val(),
                //'year': $('#year').html()
            },
            'success': function (response) {
                // format date
                if (response.success) {
                    tableBody = ''
                    response["listTH"].map(elem => {
                        elem["date"] = dateFormat2(elem["date"])
                        tableBody += "<tr>"
                        Object.keys(elem).forEach((key, index) => {
                            var value = Math.floor(elem[key]) === elem[key] ? elem[key] : parseFloat(elem[key]).toFixed(1);
                            tableBody += "<td>" + value + "</td>"
                        })
                        tableBody += "</tr>"
                    })
                    $("#mainTable tbody").html(tableBody)
                    let doanhthu = 0;
                    let metlo = 0;
                    let lothien = 0;
                    let hamlo = 0;
                    let tieuthu = 0;
                    let duonghuy = 0;
                    let trong = 0;
                    let ngoai = 0;
                    for (var j = 0; j < 16; j++) {
                        $('#mainTable thead tr:eq(1) th:eq(' + j + ') span').text(response.listKH[j].DAOLO + response.listKH[j].KHAITHAC + response.listKH[j].LOTHIEN);
                        $('#mainTable thead tr:eq(2) th:eq(' + j + ') span').text(response.listKH[j].METLO);
                        $('#mainTable thead tr:eq(3) th:eq(' + j + ') span').text(response.listKH[j].XEN);
                        doanhthu += response.listKH[j].DOANHTHU;
                        metlo += response.listKH[j].METLO;
                        lothien += response.listKH[j].LOTHIEN;
                        hamlo += response.listKH[j].DAOLO + response.listKH[j].KHAITHAC;
                        tieuthu += response.listKH[j].TIEUTHU;
                        duonghuy += response.listKH[j].DUONGHUY;
                        trong += response.listKH[j].TRONG;
                        ngoai += response.listKH[j].NGOAI;
                    }
                    $('#doanhthu-cell').text(doanhthu);
                    $('.metlo-cell').text(metlo);
                    $('#lothien-cell').text(lothien);
                    $('#hamlo-cell').text(hamlo);
                    $('#sanxuat-cell').text(hamlo + lothien);
                    $('#tieuthu-cell').text(tieuthu);
                    $('#duonghuy-cell').text(duonghuy);
                    $('#trong-cell').text(trong);
                    $('#ngoai-cell').text(ngoai);
                    $("#month").html(response.month);
                    $("#year").html(response.year);
                    if (temp != 1) {
                        successAlert("Thành công", "Đổi thành công")
                    } else {
                        temp = 0;
                    }
                } else if (!response.success) {
                    errorAlert("Có lỗi", "Chưa chọn tháng năm")
                }
            }
        })
    }

    $(".date-click").datepicker({
        onSelect: function (dateText) {
        }
    });
</script>
<script src="~/lib/datepicker_src/dist/js/i18n/datepicker.vi.js"></script>
